@if (tableData !== null) {
  <div class="table-wrapper">
    <mat-table [dataSource]="tableData" [trackBy]="trackByRowId">

      <ng-container matColumnDef="label" [sticky]="true">
        <mat-header-cell *matHeaderCellDef>
          <button mat-button (click)="createExport()">Exporteer naar Excel</button>
        </mat-header-cell>
        <mat-cell *matCellDef="let row">{{row.label}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="groeplabel" [sticky]="true">
        <mat-header-cell *matHeaderCellDef>Groepnaam</mat-header-cell>
        <mat-cell *matCellDef="let row">{{row.groeplabel}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="totalen">
        <mat-header-cell *matHeaderCellDef  class="number-column">Totalen</mat-header-cell>
        <mat-cell *matCellDef="let row" class="number-column number-input-cell">
          <input type="number" class="number-input" [value]="row.totalen" (change)="updateCategorieField($event, row.id, 'Totaal_Gepland')" />
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="total_check">
        <mat-header-cell *matHeaderCellDef  class="number-column">Check</mat-header-cell>
        <mat-cell *matCellDef="let row"
                  class="number-column"
                  [class.check-success]="row.total_check === 0"
                  [class.check-failed]="row.total_check !== 0">{{row.total_check}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="gerealiseerd">
        <mat-header-cell *matHeaderCellDef  class="number-column">Gerealiseerd</mat-header-cell>
        <mat-cell *matCellDef="let row" class="number-column number-input-cell">
          <input type="number" class="number-input" [value]="row.gerealiseerd" (change)="updateCategorieField($event, row.id, 'Totaal_Gerealiseerd')" />
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="restcapaciteit">
        <mat-header-cell *matHeaderCellDef  class="number-column info-cell">Restcapaciteit</mat-header-cell>
        <mat-cell *matCellDef="let row" class="number-column info-cell">{{row.restcapaciteit}}</mat-cell>
      </ng-container>

      @for (year of yearColumns; track $index) {
        <ng-container [matColumnDef]="'year_' + year">
          <mat-header-cell *matHeaderCellDef class="year number-column">{{year}}</mat-header-cell>
          <mat-cell *matCellDef="let row; let i = index;" class="year number-input-cell" [class.info-cell]="row.id === 'sloop-sloop'">
            @if (row.id !== 'sloop-sloop') {
              <input type="number" class="number-input" [class]="'year_' + year + '_' + i" [value]="row['year_' + year]" (change)="updateDetailField($event, row.id, year)" />
            }
          </mat-cell>
        </ng-container>
      }

      <ng-container matColumnDef="year_2043">
        <mat-header-cell *matHeaderCellDef class="year number-column expand-collapse-container">
          2043
          <button mat-button class="expand-collapse" (click)="toggleExpanded()"><mat-icon svgIcon="chevron_left"></mat-icon></button>
        </mat-header-cell>
        <mat-cell *matCellDef="let row; let i = index;" class="year number-input-cell" [class.info-cell]="row.id === 'sloop-sloop'">
          @if (row.id !== 'sloop-sloop') {
            <input type="number" class="number-input" [class]="'year_2043_' + i" [value]="row.year_2043" (change)="updateDetailField($event, row.id, 2043)" />
          }
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="year_2034_2038">
        <mat-header-cell *matHeaderCellDef class="year-group number-column">2034 - 2038</mat-header-cell>
        <mat-cell *matCellDef="let row" class="year-group number-column" [class.info-cell]="row.id === 'sloop-sloop'">
          @if (row.id !== 'sloop-sloop') {
            {{row.year_2034_2038}}
          }
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="year_2039_2043">
        <mat-header-cell *matHeaderCellDef class="year-group number-column expand-collapse-container">
          2039 - 2043
          <button mat-button class="expand-collapse" (click)="toggleExpanded()"><mat-icon svgIcon="chevron_right"></mat-icon></button>
        </mat-header-cell>
        <mat-cell *matCellDef="let row" class="year-group number-column" [class.info-cell]="row.id === 'sloop-sloop'">
          @if (row.id !== 'sloop-sloop') {
            {{row.year_2039_2043}}
          }
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="years_check">
        <mat-header-cell *matHeaderCellDef  class="number-column">Check</mat-header-cell>
        <mat-cell *matCellDef="let row"
                  class="number-column"
                  [class.info-cell]="row.id === 'sloop-sloop'"
                  [class.check-success]="row.years_check === 0"
                  [class.check-failed]="row.years_check !== 0">
          @if (row.id !== 'sloop-sloop') {
            {{row.years_check}}
          }
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="expanded ? displayedColumnsExpanded : displayedColumns; sticky: true;"></mat-header-row>
      <mat-row *matRowDef="let row; columns: expanded ? displayedColumnsExpanded : displayedColumns;" [class]="row.cls"></mat-row>

    </mat-table>
  </div>
}
